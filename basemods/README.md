Bacterial_Basemod_Analysis
==========================

This repository contains R functions and a walk-through example of how to use those functions to do custom analysis of the base modification data output by SMRTPortal.  The functions are focused on studying methylation patterns within created by the methyltransferase / restriction enzyme (MT-RE) systems found in bacterial genomes.  However, the pbh5tools.R exercise reviews the use of functions available in the R library pbh5 (available from github) that would likely be useful in analyzing other types of methylation.

To complete the exercises, you will need access to R, free software available here: http://www.r-project.org/.  New users may find RGui easier to work with than command line versions.  RGui can be used on Windows, Mac, and Unix platforms, though to use it on a unix platform your sysadmin will have to install it for you. You will also need to install the following libraries in R: Hmisc, ggplot2, Biostrings, plyr, seqinr and pbh5.  All of these are available from the R cran mirrors, with the exception of pbh5, a PacBio library that is available on github.

Having secured access to R and installed the required libraries, download this repository. Create three additional empty folders in the repository folder called 'analysis', 'circos', and 'cmph5_demo'.  Do not rename any of the files you have downloaded.  The '.R' files you downloaded contain links to the filenames, and will use the empty folders you just made to write the pdfs and csvs you will generate as you work through the exercises.  Also download the base modification example datasets which are available here:  [basemod data](https://datasets.pacb.com.s3.amazonaws.com/2013/basemod_workshop/basemod_dataset.tgz).  Put the aligned_reads.cmp.h5, modifications.gff, and modifications.csv files in the same folder as the files from this repository.

To begin, open 'basemodAnalysis.R' in R, set the folder containing the file as your working directory, and work your way through the exercises by executing sections of code and reading the accompanying commentary.  Note that to make circos plots, you will need to exit R and run circos at the command line of a unix system where circos-0.60 is installed, within the directory containing all circos text files produced during the exercise ( /circos).  Once complete, do the same with pbh5tools.R
